! switch stack port errors
sh switch stack-ports detail
sh platform hardware fed switch 1 fwd-asic register read register-name SifRacDataCrcErrorCnt-0
sh platform hardware fed switch 1 fwd-asic register read register-name SifRacRwCrcErrorCnt-0
sh platform hardware fed switch 1 fwd-asic register read register-name SifRacInvaldRingWordCnt-0
sh platform hardware fed switch 1 fwd-asic register read register-name SifRacPcsCodeWordErrorCnt-0
sh platform hardware fed switch 1 fwd-asic register read register-name SifMessageStatus
sh platform software stack-mgr switch 1 r0 sdp-counters 
!
sh platform hardware fed switch 2 fwd-asic register read register-name SifRacDataCrcErrorCnt-0
sh platform hardware fed switch 2 fwd-asic register read register-name SifRacRwCrcErrorCnt-0
sh platform hardware fed switch 2 fwd-asic register read register-name SifRacInvaldRingWordCnt-0
sh platform hardware fed switch 2 fwd-asic register read register-name SifRacPcsCodeWordErrorCnt-0
sh platform hardware fed switch 2 fwd-asic register read register-name SifMessageStatus
sh platform software stack-mgr switch 2 r0 sdp-counters 
!
sh platform hardware fed switch 3 fwd-asic register read register-name SifRacDataCrcErrorCnt-0
sh platform hardware fed switch 3 fwd-asic register read register-name SifRacRwCrcErrorCnt-0
sh platform hardware fed switch 3 fwd-asic register read register-name SifRacInvaldRingWordCnt-0
sh platform hardware fed switch 3 fwd-asic register read register-name SifRacPcsCodeWordErrorCnt-0
sh platform hardware fed switch 3 fwd-asic register read register-name SifMessageStatus
sh platform software stack-mgr switch 3 r0 sdp-counters 

! stack discovery protocol counters
sh platform software stack-mgr switch active R0 sdp-counters

! verify images
verify flash:cat9k_iosxe.17.03.05.SPA.bin
verify /md5 flash:cat9k_iosxe.17.03.05.SPA.bin

! password recovery
! Hold mode button, release -> rommon

Switch: SWITCH_IGNORE_STARTUP_CFG=1
Switch: boot


# copy start run
# conf t
(config)# no system ignore startupconfig switch all

! DNS information
sh ip dns view

! parser_cmd logs
sh platform software trace message ios switch 1 r0 | in parser_cmd
show logging process iosrp | in parser_cmd

! is traffic being evenly distributed across the physical interfaces in an etherchannel?
! probably not
sh interfaces po1 counters ethernet

! test etherchannel load-balancing
sh platform software fed switch active etherchannel 1 load-balance ipv4 192.0.2.2 192.0.2.1 

! test ECMP load-balancing
show ip cef exact-route 192.0.2.2 192.0.2.1

! auto-LAG
port-channel auto

! identify connected devices
sh device classifier attached

! device classifier profiles
sh device classifier profile type builtin

! device-tracking
sh device-tracking database details

! use a switch to do an snmp get on another switch
! OID for whyReload
cat9300(config)# snmp-server manager 
cat9300(config)# end
cat9300# snmp get v2c 198.51.100.20 cisco oid 1.3.6.1.4.1.9.2.1.2.0
SNMP Response: reqid 1, errstat 0, erridx 0 
 lsystem.2.0 = PowerOn

! list TCAM utilization
sh platform hardware fed switch 1 fwd-asic resource tcam utilization 

! my favorite uptime and reload reason command
sh logging onboard switch 1 uptime detail

! IOS 17
show tech-support confidential

! list some of the hidden show commands
! there are quite a few things under show platform that need TAC or BU documentation
show tech-support all | include "show "

! list interfaces with drops
cat9300# term shell
cat9300# sh int | grep "GigabitEthernet|output drops" | grep -v "drops: 0"

! interface up / down time information
sh int gi1/0/7 link

! list the number of times an interface has flapped, divide result by 2
sh logging | count 2/0/40.*(up|down)

! stack cables have serial numbers
show logging onboard switch active environment detail | in STACK

! commands TAC had me run to verify a memory leak bug
terminal length 0
show version
terminal exec prompt timestamp
show processes memory sorted
show processes memory platform sorted
show platform software status control-processor brief
show platform software mount switch active r0
show memory allocating-process totals 
show memory statistics
show platform resources
show platform software process list switch active r0 sort memory
show process memory platform accounting
show logging
!
show platform software memory smd switch active r0 brief
!

! information collected by device-sensor
sh device-sensor cache interface gi1/0/7

! cat9k beacon
! turn on the super bright blue LED for the hardware team
hw-module beacon slot 1 on
sh beacon all
hw-module beacon slot 1 off

! spanning tree problems, lots of topolgy changes
sh span de | in ^ VLAN|Times:

! punted packets
sh plat software fed swi act punt cause summary
sh plat software fed swi act punt rates interfaces 
sh plat software fed swi act punt packet-capture status
sh plat software fed swi act cpu-interface

! cts
sh cts
sh derived-config int gi1/0/20
sh cts interface gi1/0/20
sh cts authorization entries
sh cts policy sgt
sh derived-config | se cts

! it's interesting to see the changes in the file structure with the different IOS versions
show platform software chasfs r0

! this use to work at some point
! someone is fixing their file permissions
sh platform software file contents r0 /tmp/chassis/local/rp/chasfs/rp/0/0/etc/issue

! log logins
conf t
 login on-failure log
 login on-success log
 end
!
sh login failures

! log config changes, also needed for the revert timer
archive
 log config
  logging enable
  logging size 500
  notify syslog contenttype plaintext
  hidekeys
!
sh archive log config all

! why doesn't tacacs work?  
! what are these weird %SESSION_MGR-5-FAIL log messages on the trunk link?  
! why is there a policy on the trunk interface when running "sh access-session int gi1/0/48 detail"?
! how is the policy PMAP_DefaultWiredDot1xOpenAuth_MAB_1X getting set?  "sh run int gi1/0/48" and "sh derived-config int gi1/0/48" doesn't show any AAA configuration?
int gi1/0/48
  no access-session monitor
 
! pause or sleep when bouncing an interface
shell processing full
!
int gi1/0/1
 shutdown
 switch access vlan 2
 sleep 5
 no shutdown


